/*! fiji v0.2.0 | smt.mit-license.org */
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.Fiji=e()}(this,function(t,e,i){"use strict";var o=localStorage,s=sessionStorage,n=864e5,r=30*n,c="Fiji",h=function(t){return"undefined"!=typeof t},a=function(){function t(t){this.cache={},this.options={ttl:t&&h(t.ttl)?t.ttl:n,longTtl:t&&h(t.longTtl)?t.longTtl:r,ns:t&&h(t.ns)?t.ns:c}}return t.prototype._calculateExpiresDate=function(t,e){var i="object"==typeof e&&e.toDateString?e:new Date,o=t||this.options.ttl;return new Date(i.valueOf()+o)},t.prototype._createNewItem=function(t,e,i){var o=i?this.options.ttl:this.options.longTtl,s=this._calculateExpiresDate(o);return{id:t,value:e||null,expires:s||null,isLongTerm:i||!1}},t.prototype._getCacheItem=function(t){return this.cache[t]||null},t.prototype._setCacheItem=function(t,e){this.cache[t]=e},t.prototype._delCacheItem=function(t){h(this.cache[t])&&(this.cache[t]=null,delete this.cache[t])},t.prototype._getStoreItem=function(t){var e=h(this.cache[t])&&this.cache[t].isLongTerm?o:s,i=JSON.parse(e.getItem(this.options.ns))||{};return i[t]||null},t.prototype._setStoreItem=function(t,e){var i=e.isLongTerm?o:s,n=JSON.parse(i.getItem(this.options.ns))||{};n[t]=e,i.setItem(this.options.ns,JSON.stringify(n))},t.prototype._delStoreItem=function(t){var e=h(this.cache[t])&&this.cache[t].isLongTerm?o:s,i=JSON.parse(e.getItem(this.options.ns))||{};i[t]&&(i[t]=null,delete i[t],e.setItem(this.options.ns,JSON.stringify(i)))},t.prototype._isExpired=function(t){var e=new Date;return new Date(t.expires.valueOf())<e},t.prototype.get=function(t){var e,i,o=this._getCacheItem(t);return o?this._isExpired(o)&&(e=this._getStoreItem(t),e&&(o.value=e.value),i=o.isLongTerm?this.options.ttl:this.options.longTtl,o.expires=this._calculateExpiresDate(i),this._setStoreItem(t,o),this._setCacheItem(t,o)):(e=this._getStoreItem(t),e||(e=this._createNewItem(t,null)),this._setCacheItem(t,e),o=this._getCacheItem(t)),o.value},t.prototype.set=function(t,e,i){var o,s=this._getCacheItem(t)||this._createNewItem(t,null,i||!1);s.value=e,o=s.isLongTerm?this.options.ttl:this.options.longTtl,s.expires=this._calculateExpiresDate(o),s.isLongTerm!==!!i&&(this._delStoreItem(t),s.isLongTerm=i),this._setStoreItem(t,s),this._setCacheItem(t,s)},t.prototype.del=function(t,e){return!t&&e?(s.removeItem(this.options.ns),o.removeItem(this.options.ns),this.cache=null,void(this.cache={})):(this._delStoreItem(t),void this._delCacheItem(t))},t.prototype.list=function(){var t=this,e=Object.keys(this.cache);return e.reduce(function(e,i){return e[i]=t.get(i),e},{})},t}();return a});