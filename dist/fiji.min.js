/*! fiji v0.2.0 | smt.mit-license.org */
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.Fiji=e()}(this,function(t,e,i){"use strict";var o=window.localStorage,n=window.sessionStorage,s=864e5,r=30*s,c="Fiji",h=function(t){return"undefined"!=typeof t},a=function(){function t(t){this.cache={},this.options={ttl:t&&h(t.ttl)?t.ttl:s,longTtl:t&&h(t.longTtl)?t.longTtl:r,ns:t&&h(t.ns)?t.ns:c}}return t.prototype.calculateExpiresDate=function(t,e){var i="object"==typeof e&&e.toDateString?e:new Date,o=t||this.options.ttl;return new Date(i.valueOf()+o)},t.prototype.createNewItem=function(t,e,i){var o=i?this.options.ttl:this.options.longTtl,n=this.calculateExpiresDate(o);return{id:t,value:e||null,expires:n||null,isLongTerm:i}},t.prototype.getCacheItem=function(t){return this.cache[t]||null},t.prototype.setCacheItem=function(t,e){this.cache[t]=e},t.prototype.delCacheItem=function(t){h(this.cache[t])&&(this.cache[t]=null,delete this.cache[t])},t.prototype.getStoreItem=function(t){var e=this.cache[t].isLongTerm?o:n,i=JSON.parse(e.getItem(this.options.ns))||{};return i[t]||null},t.prototype.setStoreItem=function(t,e){var i=e.isLongTerm?o:n,s=JSON.parse(i.getItem(this.options.ns))||{};s[t]=e,i.setItem(this.options.ns,JSON.stringify(s))},t.prototype.delStoreItem=function(t){var e=this.cache[t].isLongTerm?o:n,i=JSON.parse(e.getItem(this.options.ns))||{};i[t]&&(i[t]=null,delete i[t],e.setItem(this.options.ns,JSON.stringify(i)))},t.prototype.isExpired=function(t){var e=new Date;return new Date(t.expires.valueOf())<e},t.prototype.get=function(t){var e,i,o=this.getCacheItem(t);return o?this.isExpired(o)&&(e=this.getStoreItem(t),e&&(o.value=e.value),i=o.isLongTerm?this.options.ttl:this.options.longTtl,o.expires=this.calculateExpiresDate(i),this.setStoreItem(t,o),this.setCacheItem(t,o)):(e=this.getStoreItem(t),e||(e=this.createNewItem(t,null)),this.setCacheItem(t,e),o=this.getCacheItem(t)),o.value},t.prototype.set=function(t,e,i){var o,n=this.getCacheItem(t)||this.createNewItem(t,null,i);n.value=e,o=n.isLongTerm?this.options.ttl:this.options.longTtl,n.expires=this.calculateExpiresDate(o),n.isLongTerm!==!!i&&(this.delStoreItem(t),n.isLongTerm=i),this.setStoreItem(t,n),this.setCacheItem(t,n)},t.prototype.del=function(t,e){return!t&&e?(n.removeItem(this.options.ns),o.removeItem(this.options.ns),this.cache=null,void(this.cache={})):(this.delStoreItem(t),void this.delCacheItem(t))},t.prototype.list=function(){var t=this,e=Object.keys(this.cache);return e.reduce(function(e,i){return e[i]=t.get(i),e},{})},t}();return a});