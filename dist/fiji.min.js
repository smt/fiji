/*! fiji v0.1.1 | smt.mit-license.org */
!function(e,n){"use strict";"function"==typeof define&&define.amd?define(function(){return e.Fiji=n()}):"object"==typeof exports?module.exports=e.Fiji=n():e.Fiji=n()}(this,function(){"use strict";var e,n=window.localStorage,t=window.sessionStorage,r=864e5,i=30*r,u="Fiji",o=function(n){return n!==e},l=function(n){return n===e},s=function a(s){var f=this;if(!(f instanceof a))return new a(s);var v=Object.create(null,{ttl:{value:s&&o(s.ttl)?s.ttl:r},longTtl:{value:s&&o(s.longTtl)?s.longTtl:i},ns:{value:s&&o(s.ns)?s.ns:u}}),c={},g=function(e){return e&&e.hasOwnProperty("id")&&e.hasOwnProperty("value")&&e.hasOwnProperty("expires")&&e.hasOwnProperty("isLongTerm")&&o(e.id)&&o(e.value)&&o(e.expires)&&o(e.isLongTerm)},d=function(e,n){var t="object"==typeof n&&n.toDateString?n:new Date,r=e||v.ttl;return new Date(t.valueOf()+r)},m=function(e,n,t){var r=l(n)?null:n,i=!!t;return{id:e,value:r,expires:d(t?v.ttl:v.longTtl),isLongTerm:i}},p=function(n){if(!n)return e;var t=c[n];return g(t)?t:null},T=function(n){return g(n)?void(c[n.id]=n):e},w=function(n){return n?void(o(c[n])&&(c[n]=null,delete c[n])):e},O=function(r){if(!r)return e;var i=c[r],u=g(i)&&i.isLongTerm?n:t,o=JSON.parse(u.getItem(v.ns));return o?i=l(o[r])?null:o[r]:null},y=function(r){if(!g(r))return e;var i=r.isLongTerm?n:t,u=JSON.parse(i.getItem(v.ns));u||(u={}),u[r.id]=r,i.setItem(v.ns,JSON.stringify(u))},L=function(r){if(!r)return e;var i=c[r];if(!g(i))return e;var u=i.isLongTerm?n:t,o=JSON.parse(u.getItem(v.ns));o[i.id]=null,delete o[i.id],u.setItem(v.ns,JSON.stringify(o))},j=function(n){if(!n)return e;var t=new Date;return new Date(n.expires.valueOf())<t};f.get=function(e){var n,t=(new Date,p(e));return t?j(t)&&(n=O(e),g(n)&&(t.value=n.value),t.expires=d(t.isLongTerm?v.ttl:v.longTtl),y(t),T(t)):(n=O(e),n||(n=m(e,null)),T(n),t=p(e)),t.value},f.set=function(e,n,t){var r=(new Date,p(e));r?(r.value=n,r.expires=d(r.isLongTerm?v.ttl:v.longTtl)):r=m(e,n,t),r.isLongTerm!==!!t&&(L(e),r.isLongTerm=t),y(r),T(r)},f.del=function(e,r){return!e&&r?(t.removeItem(v.ns),n.removeItem(v.ns),c=null,void(c={})):(L(e),void w(e))},f.list=function(){for(var e={},n=Object.keys(c),t=0;t<n.length;t++)e[n[t]]=f.get(n[t]);return e}};return s});